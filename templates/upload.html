{% extends "base.html"%}
{% block content %}
	<style>
		.uploadcontainer {
			width: 600px;
			height: 300px;
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			border-radius: 10px;
			box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
			margin: 200px auto; /* Center the container horizontally */
			padding: 30px; /* Add padding inside the container */
		}

		input[type="file"] {
			padding: 10px;
			margin: 10px;
			border-radius: 10px;
			border: none;
			width: 105%;
			box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.2);
		}

		 #progress-container {
            display: none;
            width: 50%;
            height: 20px;
            background-color: #ddd;
            margin-top: 20px;
        }

        #progress-bar {
            width: 0%;
            height: 100%;
            background-color: #4CAF50;
        }

	</style>

<div class="uploadcontainer">
		<h1 class="text-center py-3" style="color: black; font-size: 2rem; " >Upload PDF</h1>
		<form method="post" enctype="multipart/form-data" style="display: flex; flex-direction: column; align-items: center;">
			<input type="file" name="file">
			  <button type="submit" class="btn btn-primary btn-lg"  style="margin-top: 10px" onclick="loading()" >Add to Vault</button>
		</form>
</div>

  <div id="progress-container">
        <div id="progress-bar"></div>
    </div>

    <script type="text/javascript">
        document.getElementById('upload-form').addEventListener('submit', function (event) {
            var progressBar = document.getElementById('progress-bar');

            // Show the progress bar
            document.getElementById('progress-container').style.display = 'block';

            var fileInput = document.querySelector('input[type="file"]');
            if (fileInput.files.length > 0) {
                var formData = new FormData();
                formData.append('file', fileInput.files[0]);

                var xhr = new XMLHttpRequest();

                xhr.upload.onprogress = function (event) {
                    if (event.lengthComputable) {
                        var progress = (event.loaded / event.total) * 100;
                        progressBar.style.width = progress + '%';
                    }
                };

                xhr.onreadystatechange = function () {
                    if (xhr.readyState === XMLHttpRequest.DONE) {
                        if (xhr.status === 200) {
                            // File uploaded successfully
                            // Display success message or perform any other actions
                        } else {
                            // Error occurred during file upload
                            // Display error message or perform any other actions
                        }

                        // Hide the progress bar after upload completion
                        document.getElementById('progress-container').style.display = 'none';
                    }
                };

                xhr.open('POST', '/upload', true);
                xhr.send(formData);
            } else {
                // No file selected, prevent form submission
                event.preventDefault();
            }
        });
    </script>


{% endblock %}